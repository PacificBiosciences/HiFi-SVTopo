## SVTopo image generation

### Quick start
**Input**
SVTopoVz requires input data in `.json` or `.json.gz` format generated by SVTopo [BAM parser](/docs/svtopo_usage.md). 

```text
SVTopoVz v0.0.1
usage: svtopovz [-h] [-v] -j JSON -p OUT_PREFIX [-b BED] [--image-type {png,jpg,jpeg,svg,pdf}] [--log-level {debug,info}] [--ignore-simple-dels] [--ignore-simple-dups]

options:
  -h, --help            show this help message and exit
  -v, --version         Installed version (0.0.1)
  -j JSON, --json JSON  path to json-formatted complex SV data, extracted from BAM file using SVTopo. GZIP allowed. (default: None)
  -p OUT_PREFIX, --out-prefix OUT_PREFIX
                        prefix for output files. May include a directory path. (default: None)
  -b BED, --bed BED     paths to genome annotations in BED file format (default: None)
  --image-type {png,jpg,jpeg,svg,pdf}
                        type of image to generate (default: png)
  --log-level {debug,info}
                        set log level (default: info)
  --ignore-simple-dels  identifies simple deletions (defined as having exactly two forward spanned blocks, one forward unspanned) and skips them (default: False)
  --ignore-simple-dups  identifies simple duplications (defined as having exactly two forward spanned blocks, one reverse unspanned) and skips them (default: False)
```

Execution example (replace paths):
```bash
svtopovz \
    --json {sample_id.json} \
    --out-prefix path/to/output/directory
```

Note that unlike for SVTopo, the `--out-prefix` argument is not optional in SVTopoVz, as multiple files may be generated by SVTopoVz and the `output-prefix` is used to group outputs from the same execution. This argument allows users to pass in an explicit prefix for the PNG outputs, which may consist of a relative or absolute path. For example, the following input `--output-prefix mydirectory/sample_id` will generate images in `mydirectory` with filenames that each begin with `sample_id`.

## Advanced usage
#### Choose image type
The `--image-type` option in SVTopoVz allows users to choose the image format to generate. By default images are generated in PNG format, but users may opt for JPG/JPEG, SVG, or PDF instead. Note that all images are generated at an enhanced 400 DPI quality level.


## Runtime and output
SVTopoVz processed the json file from running SVTopo on a 30x HiFi genome in the following times:

### Default mode
* 5m51s run time
* 586 images generated

### `--ignore-simple-dups` mode
* 4m52s run time
* 493 images generated

93 simple duplication variants were skipped.

### `--ignore-simple-dels` mode
* 2m33s run time
* 242 images generated

344 simple deletions were skipped.

### `--ignore-simple-dels` and `--ignore-simple-dups` mode
* 1m37s run time
* 149 images generated
  
#### Algorithm notes:
* Undersized blocks: SVTopoVZ is intended to display structural rearrangements, but it may in some cases also show quite small insertion/deletion evidence. These may represent real rearrangements or small alignment errors. These are omitted from plots if under 10bp in length, but they are still assigned a letter in chain plots to allow inference of their existence. A chain plot showing blocks labeled A, B, and D therefore also has a block C that is not shown.
